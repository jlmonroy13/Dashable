!function(){angular.module("CheckIn",["ngRoute","angular-google-gapi","LocalStorageModule","selectize","angular-momentjs","ngLoadingSpinner"])}(),function(){function a(a){a.when("/checkin",{templateUrl:"/assets/templates/pages/checkin/index.html",controller:"getProjectsController",controllerAs:"projectsCtrl"}).when("/history",{templateUrl:"/assets/templates/pages/history/index.html",controller:"getHistoryController",controllerAs:"historyCtrl"}).when("/",{templateUrl:"/assets/templates/pages/home/index.html",controller:"loginController",controllerAs:"login"}).otherwise({redirectTo:"/"})}angular.module("CheckIn").config(a),a.$inject=["$routeProvider"]}(),function(){function a(a,b,c,d,e){e.gdata=d;var f="767533878479-svf3420ha7ggdrgoqq78kuanbm777ckc.apps.googleusercontent.com";c.load("oauth2","v2"),b.setClient(f),b.setScope("https://www.googleapis.com/auth/userinfo.email")}function b(a,b,c){a.setPrefix("CheckIn").setNotify(!0,!0),b.interceptors.push("httpInterceptorFactory"),c.asyncLoading(!1).scriptUrl("//cdnjs.cloudflare.com/ajax/libs/moment.js/2.5.1/moment.min.js")}function c(){return function(a){return a.slice().reverse()}}angular.module("CheckIn").run(a),a.$inject=["$location","GAuth","GApi","GData","$rootScope"],angular.module("CheckIn").config(b),b.$inject=["localStorageServiceProvider","$httpProvider","$momentProvider"],angular.module("CheckIn").filter("reverse",c)}(),function(){function a(a,b,c,d){function e(){function d(a){}function e(){return b.login().then(g)}function g(){return console.log(c.getUser()),b.getToken().then(h)}function h(b){return console.log(b),a.post("http://dashable-netsuite-api-prod.herokuapp.com/users/auth/google_oauth2/callback?access_token="+b.access_token).then(function(a){return console.log(a),f("jwt",a.data.response.jwt),a.data})}return b.checkAuth().then(d,e)}function f(a,b){return d.set(a,b)}var g={login:e};return g}angular.module("CheckIn").factory("authenticationFactory",a),a.$inject=["$http","GAuth","GData","localStorageService"]}(),function(){function a(a){var b={request:function(b){var c=a.get("jwt");return""!==c&&(b.headers.Authorization="Bearer "+c),b}};return b}angular.module("CheckIn").factory("httpInterceptorFactory",a),a.$inject=["localStorageService"]}(),function(){function a(a){function b(){var b={async:!0,crossDomain:!0,url:h+"api/1/projects",method:"GET",headers:{"content-type":"application/json"}};return a(b).then(function(a){return a.data})}function c(b){var c={async:!0,crossDomain:!0,url:h+"api/1/projects/"+b+"/tasks",method:"GET",headers:{"content-type":"application/json"}};return a(c).then(function(a){return a.data})}function d(){var b={async:!0,crossDomain:!0,url:h+"api/1/time_bills/recent",method:"GET",headers:{"content-type":"application/json"}};return a(b).then(function(a){return a.data})}function e(){var b={async:!0,crossDomain:!0,url:h+"api/1/time_bills/history",method:"GET",headers:{"content-type":"application/json"}};return a(b).then(function(a){return a.data})}function f(b){return a.post(h+"api/1/time_bills",b).then(function(a){return a})}function g(b){return a["delete"](h+"api/1/time_bills/"+b).then(function(a){return a})}var h="http://dashable-netsuite-api-prod.herokuapp.com/",i={getUserProjects:b,getProjectTask:c,getTimeBills:d,getCheckinsHistory:e,createCheckin:f,deleteCheckin:g};return i}angular.module("CheckIn").factory("checkinFactory",a),a.$inject=["$http"]}(),function(){function a(a){function b(){i=[],g=moment().day("Saturday"),h=parseInt(moment(g).toNow()),isNaN(h)&&(h=1),i.push({day:a().format("dddd"),numberday:a().format("D"),dateToDisplay:a().format("dddd, MMM D"),date:a().format("YYYY-MM-DD"),selected:!0,checkin:!1,future:!1}),5==h?c(3):4==h?c(5):3==h?c(7):2==h?c(9):1==h&&c(11);for(var b=1;h+1>b;b++)d=a().add(b,"days").format("YYYY-MM-DD"),e=a().add(b,"days").format("dddd"),f=a().add(b,"days").format("D"),dateToDisplay=a().add(b,"days").format("dddd, MMM D"),i.unshift({day:e,numberday:f,dateToDisplay:dateToDisplay,date:d,selected:!1,checkin:!1,future:!0});return i=$.grep(i,function(a){return"Sunday"!=a.day})}function c(b){for(var c=1;h+b>c;c++)d=a().subtract(c,"days").format("YYYY-MM-DD"),e=a().subtract(c,"days").format("dddd"),f=a().subtract(c,"days").format("D"),dateToDisplay=a().subtract(c,"days").format("dddd, MMM D"),i.push({day:e,numberday:f,dateToDisplay:dateToDisplay,date:d,selected:!1,checkin:!1,future:!1})}var d,e,f,g,h,i=[],j={get2weeks:b};return j}angular.module("CheckIn").factory("getweeksFactory",a),a.$inject=["$moment"]}(),function(){function a(a){function b(){function b(b){console.log(b.id),vm.deleteCheckin={time_bill:{project_id:b.project.id,task_id:b.task.id,duration:b.hours,tran_date:b.date,memo:b.memo}},console.log(vm.deleteCheckin),a.deleteCheckin(b.id).then(function(a){console.log(a),vm.deleteStatus=!0})}vm=this,vm.removeCheckin=b,vm.deleteCheckin={time_bill:{project_id:"",task_id:"",duration:"",tran_date:"",memo:""}}}var c={restrict:"E",templateUrl:"/assets/templates/pages/history/history-items.html",bindToController:{checkins:"=",deleteStatus:"="},controllerAs:"vm",controller:b};return c}angular.module("CheckIn").directive("historyItems",a),a.$inject=["checkinFactory"]}(),function(){function a(){function a(){function a(a){0==a.future&&(vm.date={dateToDisplay:a.dateToDisplay,day:a.day,numberday:a.numberday,dateFormat:a.date},b(a))}function b(a){vm.resetSelectedDates(),a.selected=!0,vm.checkin.time_bill.tran_date=vm.date.dateFormat}vm=this,vm.getDate=a}var b={restrict:"E",templateUrl:"/assets/templates/pages/checkin/calendar-week.html",bindToController:{week:"=",date:"=",checkin:"=",resetSelectedDates:"&"},controllerAs:"vm",controller:a};return b}angular.module("CheckIn").directive("calendarWeek",a)}(),function(){function a(a,b,c,d){function e(){b.login().then(function(a){d.path("/checkin")})}var f=this;f.login=e}angular.module("CheckIn").controller("loginController",a),a.$inject=["$window","authenticationFactory","checkinFactory","$location"]}(),function(){function a(a,b,c,d){function e(){a.getUserProjects().then(f)}function f(a){angular.forEach(a.response,function(a,b){v.optionsProjects.push({value:a.id,text:a.title})})}function g(a){v.optionsTask=[],u=a,h(u),v.newCheckin.time_bill.project_id=u}function h(b){a.getProjectTask(b).then(i)}function i(a){angular.forEach(a.response,function(a,b){v.optionsTask.push({value:a.id,text:a.title})}),v.newCheckin.time_bill.task_id=a.response[0].id,v.newCheckin.time_bill.tran_date=v.selectedDate.dateFormat}function j(){v.dates=b.get2weeks()}function k(){a.getTimeBills().then(l)}function l(a){j(),v.last12Checkins=a.response,angular.forEach(v.last12Checkins,function(a,b){a.dateformat=a.date.slice(0,10)}),m(v.last12Checkins,v.dates)}function m(a,b){angular.forEach(b,function(b,c){angular.forEach(a,function(a,c){a.dateformat===b.date&&(b.checkin=!0)})}),n()}function n(){v.lastWeek=v.dates.slice(6,12),v.actualWeek=v.dates.slice(0,6),v.selectWeek=v.actualWeek}function o(a){v.selectWeek=a,p()}function p(){v.statusButton=!v.statusButton}function q(a){angular.forEach(v.dates,function(a,b){a.selected=!1})}function r(){t=v.newCheckin.time_bill,s(),""!==t.project_id&&""!==t.task_id&&""!==t.duration&&""!==t.tran_date&&""!==t.memo&&a.createCheckin(v.newCheckin).then(function(a){v.checkinDone=!0,console.log(a)})}function s(){""==t.project_id?v.statusCheckin.project=!0:v.statusCheckin.project=!1,""==t.task_id?v.statusCheckin.task=!0:v.statusCheckin.task=!1,""==t.duration?v.statusCheckin.duration=!0:v.statusCheckin.duration=!1,""==t.memo?v.statusCheckin.memo=!0:v.statusCheckin.memo=!1}var t,u,v=this;v.configProjectsSelectize={maxItems:1},v.dates=[],v.actualWeek=[],v.lastWeek=[],v.last12Checkins=[],v.selectWeek=[],v.changeWeek=o,v.statusButton=!0,v.selectedDate={dateToDisplay:moment().format("dddd, MMM D"),day:d().format("dddd"),numberday:d().format("D"),dateFormat:d().format("YYYY-MM-DD")},v.resetSelectedDates=q,v.createCheckin=r,v.getProjects=e,v.getProjectId=g,v.checkinDone=!1,v.statusCheckin={project:!1,task:!1,duration:!1,memo:!1},v.newCheckin={time_bill:{project_id:"",task_id:"",duration:"",tran_date:"",memo:""}},k(),e()}angular.module("CheckIn").controller("getProjectsController",a),a.$inject=["checkinFactory","getweeksFactory","$timeout","$moment"]}(),function(){function a(a){function b(){a.getCheckinsHistory().then(c)}function c(a){console.log(a),d.history=a.response}var d=this;d.getCheckinsHistory=b,d.wasDeleted=!1,b()}angular.module("CheckIn").controller("getHistoryController",a),a.$inject=["checkinFactory"]}();